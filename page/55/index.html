<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lysp2017.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="高山流水">
<meta property="og:url" content="http://lysp2017.github.io/page/55/index.html">
<meta property="og:site_name" content="高山流水">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Louyan">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://lysp2017.github.io/page/55/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>高山流水</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="/custom_css_source.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">高山流水</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">但问耕耘，莫问收获</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/28/rate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/28/rate/" class="post-title-link" itemprop="url">标准化(Standardization)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-28 12:36:58" itemprop="dateCreated datePublished" datetime="2018-07-28T12:36:58+08:00">2018-07-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-02-27 23:43:51" itemprop="dateModified" datetime="2019-02-27T23:43:51+08:00">2019-02-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">统计学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="一摘要">一、摘要</h2>
<ol type="1">
<li>要比较两个总率时，发现两组人群的内部构成（如年龄、性别构成等）存在明显不同，而且影响到了总率比较的结果，这时就不宜再直接比较总率，而应考虑采用标准化法。标准化法的基本思想，就是采用统一的标准（统一的内部构成）计算出消除内部构成不同影响后的标准化率，然后再进行比较。</li>
<li>在直接年龄调整中(direct
age-adjustment)，使用常见的年龄结构人口作为标准。这个年龄结构人口可能是实际存在的（例如1999年的美国人口），也可能是虚构的（例如，可以组合两个群体以创建标准人群）。</li>
<li>在间接年龄调整中(indirect
age-adjustment)，一组共同的年龄特定比率(age-specific
rates)应用于将率标准化的人群。最简单和最有用的间接调整形式是标准化死亡率（SMR）。</li>
</ol>
<h2 id="二前言">二、前言</h2>
<p>比较两个或多个不同地理区域的死亡率和发病率对于评估社区健康状况非常重要。由于在不同的人群中可能存在不同的频率分布，因此粗率(crude
rates)之间的比较容易产生误导，因为粗率对人群的健康状况的信息不是很全面。需要对在比较中有差异的特征进行标准化。</p>
<p>年龄和性别是两个最常见的用于标准化的变量，它们被称为标准化率(standardized
rates)。</p>
<p>粗率与标准化率之间的区别在于，粗率是根据所研究的人群整体计算的，而标准化率则是基于特定的作为标准的特征(particular
characteristics)。</p>
<p>如果基于特定特征计算“率”，则将它们称为“特定的率”(specific
rates)（例如age-specific mortality rate/特定年龄死亡率）。</p>
<p>本文试图帮助研究者选择和使用合适的标准化方法。有两种计算标准化率的方法，即直接和间接标准化(direct
and indirect standardization)。</p>
<p>下面的例子都是围绕基于年龄标准化率(age-standardized
rates)的标准化方法。</p>
<h2 id="三直接标准化">三、直接标准化</h2>
<h3
id="一直接标准化的概念与应用条件">（一）直接标准化的概念与应用条件</h3>
<ol type="1">
<li>当已知两个或更多人群的特定年龄死亡率(age-specific mortality
rates)时，可以应用直接标准化方法。</li>
<li>直接标准化的思路：调整原因，即人口构成差异。利用标准人口构成调整死亡率。</li>
</ol>
<figure>
<img src="http://qiniup.louyanspine.com/2018-07-28-MJMS-7-1-010-g1.jpg"
alt="Figure 1: Concept of direct standardization" />
<figcaption aria-hidden="true">Figure 1: Concept of direct
standardization</figcaption>
</figure>
<h3 id="二直接标准化方法步骤">（二）直接标准化方法步骤</h3>
<ol type="1">
<li><p>计算每个人群中每个年龄组的特定年龄死亡率。</p></li>
<li><p>然后选择其中一个人群作为标准（参考）人群。</p>
<blockquote>
<p>注意：如果将特定人群的死亡率与全国人口进行比较，则全国人口将被视为“标准”人群</p>
</blockquote></li>
<li><p>将所研究的其他人群的特定年龄死亡率乘以标准人口的每个年龄组的人数。</p></li>
<li><p>通过这种方式，可以获得每个人群每个年龄组的预期死亡人数(expected
death)。将预期死亡总数除以标准人口数(standard population)
，从而得到年龄校正的死亡率(age-adjusted mortality rates)。</p></li>
<li><p>通过比较两个人群的特定年龄死亡率来得出结论。</p>
<figure>
<img src="http://qiniup.louyanspine.com/2018-07-28-MJMS-7-1-010-g2.jpg"
alt="Figure 2:Procedure for application of direct standardization method" />
<figcaption aria-hidden="true">Figure 2:Procedure for application of
direct standardization method</figcaption>
</figure></li>
</ol>
<h3 id="三实例">（三）实例</h3>
<p>在讨论粗死亡率时，人群B的死亡率似乎高于人群A。选择全国人口作为参考人群(reference
population)，因此计算如下：</p>
<p><img
src="http://qiniup.louyanspine.com/2018-07-31-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-31%20%E4%B8%8A%E5%8D%8810.53.14.png" /></p>
<figure>
<img
src="http://qiniup.louyanspine.com/2018-07-31-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-31%20%E4%B8%8A%E5%8D%8810.14.23.png"
alt="Table 2:Calculation of expected deaths by applying direct standardization method" />
<figcaption aria-hidden="true">Table 2:Calculation of expected deaths by
applying direct standardization method</figcaption>
</figure>
<p>预计死亡(expected deaths)总人数：</p>
<ul>
<li><p>Population A = 1186.18</p></li>
<li><p>Population B = 1158.99</p></li>
<li><p>Age adjusted death rate for population A</p>
<p><span
class="math display">\[=\cfrac{1186.18}{51000}\times1000=23.3/1000
population\]</span></p></li>
<li><p>Age adjusted death rate for population B</p>
<p><span
class="math display">\[=\cfrac{1158.99}{51000}\times1000=22.7/1000
population\]</span></p></li>
<li><p>当讨论age-adjusted
rates时，实际上人群A的死亡风险高于人群B。如果仅仅依靠粗死亡率，你可能会得到误导性的结论。</p></li>
</ul>
<h2 id="四间接标准化">四、间接标准化</h2>
<h3
id="一间接标准化的概念与应用条件">（一）间接标准化的概念与应用条件</h3>
<ol type="1">
<li>当感兴趣的人群的特定年龄死亡率未知时，只有每个年龄组人口数和观察到的死亡总数时，可应用间接标准化方法。</li>
<li>间接标准化的思路：调整结果，即死亡率。利用标准死亡率调整粗死亡率。</li>
</ol>
<figure>
<img src="http://qiniup.louyanspine.com/2018-07-31-MJMS-7-1-010-g3.jpg"
alt="Figure 3:Concept of indirect standardization" />
<figcaption aria-hidden="true">Figure 3:Concept of indirect
standardization</figcaption>
</figure>
<h3 id="二间接标准化的步骤">（二）间接标准化的步骤</h3>
<ol type="1">
<li><p>选择参考或标准人口。</p></li>
<li><p>计算感兴趣的人群中观察到的死亡人数。</p></li>
<li><p>将所选参考人群的特定年龄死亡率应用于感兴趣的人群。</p></li>
<li><p>将感兴趣人群的每个年龄组中的人数乘以参考人群中相应年龄组中的特定年龄死亡率。</p></li>
<li><p>将每个感兴趣的人群的预期死亡总数相加。</p></li>
<li><p>将观察到的人群死亡总数除以预期的死亡人数。</p>
<figure>
<img src="http://qiniup.louyanspine.com/2018-07-31-MJMS-7-1-010-g4.jpg"
alt="Figure 4:Procedure for application of indirect standardization method" />
<figcaption aria-hidden="true">Figure 4:Procedure for application of
indirect standardization method</figcaption>
</figure>
<ul>
<li><p>观察到的死亡人数与预期死亡人数的比率称为“标准化死亡率”或SMR：<span
class="math display">\[SMR=\cfrac{观察到的死亡人数}{预期的死亡人数}\]</span></p></li>
<li><p>调整后的死亡率（Adjusted mortality rates,AMR）：<span
class="math display">\[AMR = SMR \times CDR(Standard)\]</span></p>
<blockquote>
<p>如果应用参考人群的特定年龄死亡率，必须从该参考人群中计算粗死亡率(CDR)。</p>
</blockquote></li>
</ul></li>
</ol>
<h3 id="三实例-1">（三）实例</h3>
<p><img
src="http://qiniup.louyanspine.com/2018-07-31-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-31%20%E4%B8%8A%E5%8D%8810.53.19.png" /></p>
<p>观察到的人群A和B的死亡情况如下（前提已知条件）：</p>
<ul>
<li>Observed deaths in population A = 120</li>
<li>Observed deaths in population B = 30</li>
</ul>
<p>将观察到的死亡总人数除以预期死亡总人数。</p>
<ul>
<li><p>SMR for population A <span
class="math inline">\(=\cfrac{120}{195.5}\times1000=0.61\)</span></p></li>
<li><p>SMR for population B <span
class="math inline">\(=\cfrac{30}{69.5}\times1000=0.43\)</span></p></li>
<li><p>在根据年龄调整差异后，人群A中的死亡风险实际上高于人群B。</p></li>
</ul>
<h2 id="五结论">五、结论</h2>
<p>标准化方法并不困难，但有时研究者对选择哪种方法以及如何计算和应用特定的方法存在一些困惑。真诚希望本文可以提高研究者对标准化方法的理解，从而可以比较两种或更多在某些特征上存在差异的群体。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/26/post-exposure-covariate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/26/post-exposure-covariate/" class="post-title-link" itemprop="url">post-exposure covariate????（未完）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-26 10:35:05" itemprop="dateCreated datePublished" datetime="2018-07-26T10:35:05+08:00">2018-07-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-02-28 00:45:36" itemprop="dateModified" datetime="2019-02-28T00:45:36+08:00">2019-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">统计学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote>
<p>说明<br> 1. 译自Keith Goldfeld的文章：Be careful not to control for a
post-exposure covariate</p>
</blockquote>
<p>一位研究人员正在分析不同类型的童年创伤可能对成年时药物滥用产生的影响。显然，这是一个非常有趣且具有挑战性的研究问题。显然，这是一个非常有趣且具有挑战性的研究问题。</p>
<p>统计模型包含了对若干因素的调整。这些因素是童年创伤和药物滥用之间关系可能的混淆因素，如儿童时家境贫穷。然而，该模型还包括对成年时家境贫穷的测量(a
measurement for poverty in adulthood)
，认为它在某种程度上混淆了童年创伤和药物滥用之间的关系。</p>
<p>混淆是暴露/治疗(exposure/treatment)与结果(outcome)之间的常见原因(cause)。很难将成年时家境贫穷视为童年时事件(childhood
events)的原因(cause)，尽管它可能与成年时药物滥用有关（或许无关）。</p>
<p>最多，成年时家境贫穷这个因素被调整控制(control)后，对研究结论没有影响；然而，不太好的是，它可能导致童年创伤的影响小于实际的结果。</p>
<p>使用模拟的数据和潜在结果的抽象概念，我希望能够阐明这种分析引起的一些问题。</p>
<h3
id="潜在的结果与因果效应potential-outcomes-and-causal-effects">潜在的结果与因果效应/Potential
outcomes and causal effects</h3>
<p>我的目标是提出潜在结果的概念，以便我们能够至少清楚地阐明一种可以定义因果效应的明确方法。</p>
<p>在这个框架下，我们生成模拟数据，从而可以找到因果效应的“真实”测量(“true”
measure of causal
effect)。然后我们可以使用简单的回归模型来看看他们是否很够很好地重新获得这些“已知”的因果效应。</p>
<p>如果某一个体 <span
class="math inline">\(i\)</span>，在儿童期经历了创伤(traumatic
effect)，我们可以说该个体 <span
class="math inline">\(i\)</span>的暴露(exposure)为 <span
class="math inline">\(X_i=1\)</span>,反之，没有经历创伤，则为 <span
class="math inline">\(X_i=0\)</span>。可以认为，每一个个体，都有潜在的结果(possible
outcomes) <span class="math inline">\(Y_{1i}\)</span> 和 <span
class="math inline">\(Y_{0i}\)</span>。<span
class="math inline">\(Y_{1i}\)</span>
是指如果个体经历过创伤，我们会观察到的结果。<span
class="math inline">\(Y_{0i}\)</span>
则相反，是指如果个体没有经历过创伤，我们会观察到的结果。</p>
<p>我们定义<span class="math inline">\(Y\)</span>为结果，<span
class="math inline">\(X\)</span>为原因，则潜在结果的差异为 <span
class="math inline">\(CE_i= Y_{1i} - Y_{0i}\)</span>。如果<span
class="math inline">\(Y_{1i} =
Y_{0i}\)</span>，即两者的潜在结果相同，那么我们可以说，对于个体 <span
class="math inline">\(i\)</span>而言，<span
class="math inline">\(X\)</span>并不会导致<span
class="math inline">\(Y\)</span>。</p>
<p>在现实世界中，我们只观察到一个潜在的结果：与实际暴露相关的结果。</p>
<p>在因果推理领域，对于我们使用观测数据估计平均因果效应所需的假设和条件有很多限制。许多人会说，除非我们使用随机对照研究，否则这些假设不合理。但在使用模拟数据时，我们可以产生潜在结果(potential
outcomes)和观测结果(observed
outcomes)。因此，我们知道个体水平和平均人口水平的因果效应。同时，我们还可以看到我们的模型拟合得有多好。</p>
<h3 id="simple-confounding简单的混淆">Simple confounding/简单的混淆</h3>
<p>这是一个相对简单的例子。<span
class="math inline">\(Y\)</span>为结果，<span
class="math inline">\(X\)</span>为原因。还有一个共同的影响因素<span
class="math inline">\(C\)</span>。</p>
<p><img
src="http://qiniup.louyanspine.com/2018-07-26-SimpleCausal.png" /></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>broom<span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#用于将统计模型的结果整理成数据框形式</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>data.table<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#快速处理大数据集</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>simstudy<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">def <span class="operator">&lt;-</span> defData<span class="punctuation">(</span>varname <span class="operator">=</span> <span class="string">&quot;C&quot;</span><span class="punctuation">,</span> formula <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">,</span> dist <span class="operator">=</span> <span class="string">&quot;binary&quot;</span><span class="punctuation">)</span></span><br><span class="line">def <span class="operator">&lt;-</span> defData<span class="punctuation">(</span>def<span class="punctuation">,</span> <span class="string">&quot;X&quot;</span><span class="punctuation">,</span> formula <span class="operator">=</span> <span class="string">&quot;0.3 + 0.4 * C&quot;</span><span class="punctuation">,</span> dist <span class="operator">=</span> <span class="string">&quot;binary&quot;</span><span class="punctuation">)</span></span><br><span class="line">def <span class="operator">&lt;-</span> defData<span class="punctuation">(</span>def<span class="punctuation">,</span> <span class="string">&quot;e&quot;</span><span class="punctuation">,</span> formula <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> variance <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> dist <span class="operator">=</span> <span class="string">&quot;normal&quot;</span><span class="punctuation">)</span></span><br><span class="line">def <span class="operator">&lt;-</span> defData<span class="punctuation">(</span>def<span class="punctuation">,</span> <span class="string">&quot;Y0&quot;</span><span class="punctuation">,</span> formula <span class="operator">=</span> <span class="string">&quot;2 * C + e&quot;</span><span class="punctuation">,</span> dist<span class="operator">=</span><span class="string">&quot;nonrandom&quot;</span><span class="punctuation">)</span></span><br><span class="line">def <span class="operator">&lt;-</span> defData<span class="punctuation">(</span>def<span class="punctuation">,</span> <span class="string">&quot;Y1&quot;</span><span class="punctuation">,</span> formula <span class="operator">=</span> <span class="string">&quot;0.5 + 2 * C + e&quot;</span><span class="punctuation">,</span> dist<span class="operator">=</span><span class="string">&quot;nonrandom&quot;</span><span class="punctuation">)</span></span><br><span class="line">def <span class="operator">&lt;-</span> defData<span class="punctuation">(</span>def<span class="punctuation">,</span> <span class="string">&quot;Y_obs&quot;</span><span class="punctuation">,</span> formula <span class="operator">=</span> <span class="string">&quot;Y0 + (Y1 - Y0) * X&quot;</span><span class="punctuation">,</span> dist <span class="operator">=</span> <span class="string">&quot;nonrandom&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">def</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">##        varname        formula   variance  dist     link</span><br><span class="line">## 1:       C                0.4        0    binary identity</span><br><span class="line">## 2:       X      0.3 + 0.4 * C        0    binary identity</span><br><span class="line">## 3:       e                  0        2    normal identity</span><br><span class="line">## 4:      Y0          2 * C + e        0 nonrandom identity</span><br><span class="line">## 5:      Y1    0.5 + 2 * C + e        0 nonrandom identity</span><br><span class="line">## 6:   Y_obs Y0 + (Y1 - Y0) * X        0 nonrandom identity</span><br></pre></td></tr></table></figure>
<p>在上述的例子里，<span class="math inline">\(X\)</span>和<span
class="math inline">\(C\)</span>均对<span
class="math inline">\(Y\)</span>产生了一定的影响。如果我们在评估<span
class="math inline">\(X\)</span>对<span
class="math inline">\(Y\)</span>的效应大小时，忽略了因素<span
class="math inline">\(C\)</span>，我们会高估这种效应大小(即0.5)。</p>
<p>我们可以生成数据并看到这种情况：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set.seed<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">dt <span class="operator">&lt;-</span> genData<span class="punctuation">(</span><span class="number">1000</span><span class="punctuation">,</span> def<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">        id C X       e            Y0          Y1         Y_obs</span><br><span class="line">   1:    1 0 0 -2.057757922 -2.057757922 -1.5577579 -2.057757922</span><br><span class="line">   2:    2 1 1  1.760077725  3.760077725  4.2600777  4.260077725</span><br><span class="line">   3:    3 1 1 -0.610865399  1.389134601  1.8891346  1.889134601</span><br><span class="line">   4:    4 0 0  0.009714623  0.009714623  0.5097146  0.009714623</span><br><span class="line">   5:    5 0 1  0.176141782  0.176141782  0.6761418  0.676141782</span><br><span class="line">  ---                                                           </span><br><span class="line"> 996:  996 1 1 -0.147379631  1.852620369  2.3526204  2.352620369</span><br><span class="line"> 997:  997 0 0  1.336474722  1.336474722  1.8364747  1.336474722</span><br><span class="line"> 998:  998 0 0 -0.127816908 -0.127816908  0.3721831 -0.127816908</span><br><span class="line"> 999:  999 0 1  0.022055022  0.022055022  0.5220550  0.522055022</span><br><span class="line">1000: 1000 0 0 -0.292353254 -0.292353254  0.2076467 -0.292353254</span><br></pre></td></tr></table></figure>
<p>我们看到，如果我们能够获得潜在的结果<span
class="math inline">\(Y_{1}\)</span> 和 <span
class="math inline">\(Y_{0}\)</span>，那么就很容易获得真正的因果效应，但显然，我们无法获得潜在的结果<span
class="math inline">\(Y_{1}\)</span> 和 <span
class="math inline">\(Y_{0}\)</span>。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dt<span class="punctuation">[</span><span class="punctuation">,</span> mean<span class="punctuation">(</span>Y1 <span class="operator">-</span> Y0<span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># True causal effect</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## [1] 0.5</span></span><br></pre></td></tr></table></figure>
<p>如果我们比较每个暴露组的平均观察结果而忽略混杂因素(confounder)，我们会高估暴露的影响：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dt<span class="punctuation">[</span>X <span class="operator">==</span> <span class="number">1</span><span class="punctuation">,</span> mean<span class="punctuation">(</span>Y_obs<span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">-</span> dt<span class="punctuation">[</span>X <span class="operator">==</span> <span class="number">0</span><span class="punctuation">,</span> mean<span class="punctuation">(</span>Y_obs<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## [1] 1.285009</span></span><br></pre></td></tr></table></figure>
<p>我们可以使用简单的线性回归估计相同的效果：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lm1 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Y_obs <span class="operator">~</span> X<span class="punctuation">,</span> data <span class="operator">=</span> dt<span class="punctuation">)</span></span><br><span class="line">tidy<span class="punctuation">(</span>lm1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##          term  estimate  std.error statistic      p.value</span></span><br><span class="line"><span class="comment">## 1 (Intercept) 0.5515963 0.07325865  7.529436 1.137854e-13</span></span><br><span class="line"><span class="comment">## 2           X 1.2850091 0.10674523 12.038094 2.916261e-31</span></span><br></pre></td></tr></table></figure>
<p>如果我们调整混淆因素<span
class="math inline">\(C\)</span>，我们可以获得<span
class="math inline">\(X\)</span>对<span
class="math inline">\(Y\)</span>的真正（或接近）因果效应。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lm2 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Y_obs <span class="operator">~</span> X <span class="operator">+</span> C<span class="punctuation">,</span> data <span class="operator">=</span> dt<span class="punctuation">)</span></span><br><span class="line">tidy<span class="punctuation">(</span>lm2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">##          term   estimate  std.error statistic      p.value</span><br><span class="line">## 1 (Intercept) 0.08491216 0.06502545  1.305830 1.919117e-01</span><br><span class="line">## 2           X 0.48935880 0.09678110  5.056347 5.083959e-07</span><br><span class="line">## 3           C 2.05729945 0.09825925 20.937464 5.767575e-81</span><br></pre></td></tr></table></figure>
<h3 id="调整暴露后的协变量">调整暴露后的协变量</h3>
<p><img
src="http://qiniup.louyanspine.com/2018-07-26-ComplexCausal.png" /></p>
<p>在这种情况下，混淆因素<span
class="math inline">\(C\)</span>在两个阶段被测量，同时，暴露在period
1的效应与period
2有关（例如，如果童年时贫穷，成年后就更容易贫穷）。我们关心的是，是否<span
class="math inline">\(X\)</span>(童年创伤)会导致<span
class="math inline">\(Y\)</span>（药物滥用）。困难在于<span
class="math inline">\(C_2\)</span>和<span
class="math inline">\(X\)</span>、<span
class="math inline">\(Y\)</span>均有关系。</p>
<p>为了充分了解<span class="math inline">\(X\)</span>对于<span
class="math inline">\(Y\)</span>的效果，我们不能控制<span
class="math inline">\(C_2\)</span>。直觉在于<span
class="math inline">\(X\)</span>对于<span
class="math inline">\(Y\)</span>的部分效应，来源于<span
class="math inline">\(X\)</span>对<span
class="math inline">\(C_2\)</span>的作用。如果我们控制了<span
class="math inline">\(C_2\)</span>，则移除了因果机制中关键部分。下面是数据生成过程：</p>
<ol type="1">
<li>基于暴露因素<span class="math inline">\(X\)</span>，<span
class="math inline">\(C_2\)</span>有潜在的结果。</li>
<li>我们限制了潜在的结果<span
class="math inline">\(C_{21}\)</span>为1，如果<span
class="math inline">\(C_{20}\)</span>是1的话。例如，如果有人在没有受到童年创伤的情况下，成年后也很穷。我们则会认为，如果他们在童年遭受创伤，他们成年后也会很穷。</li>
<li><span class="math inline">\(Y\)</span>的潜在结果，依赖于<span
class="math inline">\(C_2\)</span>的相关潜在结果。<span
class="math inline">\(Y_0\)</span>依赖于<span
class="math inline">\(C_{20}\)</span>，而<span
class="math inline">\(Y_1\)</span>则依赖于<span
class="math inline">\(C_{21}\)</span>。</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##     varname                  formula variance      dist     link</span></span><br><span class="line"><span class="comment">##  1:      C1                     0.25        0    binary identity</span></span><br><span class="line"><span class="comment">##  2:       X            -2 + 0.8 * C1        0    binary    logit</span></span><br><span class="line"><span class="comment">##  3:    C2.0            -2.0 + 1 * C1        0    binary    logit</span></span><br><span class="line"><span class="comment">##  4:   C2.1x            -1.5 + 1 * C1        0    binary    logit</span></span><br><span class="line"><span class="comment">##  5:    C2.1        pmax(C2.0, C2.1x)        0 nonrandom identity</span></span><br><span class="line"><span class="comment">##  6:       e                        0        4    normal identity</span></span><br><span class="line"><span class="comment">##  7:      Y0          -3 + 5*C2.0 + e        0 nonrandom identity</span></span><br><span class="line"><span class="comment">##  8:      Y1           0 + 5*C2.1 + e        0 nonrandom identity</span></span><br><span class="line"><span class="comment">##  9:  C2_obs C2.0 + (C2.1 - C2.0) * X        0 nonrandom identity</span></span><br><span class="line"><span class="comment">## 10:   Y_obs       Y0 + (Y1 - Y0) * X        0 nonrandom identity</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set.seed<span class="punctuation">(</span><span class="number">25</span><span class="punctuation">)</span></span><br><span class="line">dt <span class="operator">&lt;-</span> genData<span class="punctuation">(</span><span class="number">5000</span><span class="punctuation">,</span> def2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/22/simstudypackage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/22/simstudypackage/" class="post-title-link" itemprop="url">用simstudy包模拟出相似数据集（未完）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-22 19:32:55" itemprop="dateCreated datePublished" datetime="2018-07-22T19:32:55+08:00">2018-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-02-28 00:42:31" itemprop="dateModified" datetime="2019-02-28T00:42:31+08:00">2019-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="基础">基础</h2>
<p>使用<code>simstudy包</code>进行模拟有两个基本步骤。首先，用户在外部csv文件中或通过一组重复的定义语句在内部定义数据集的数据元素。其次，用户使用这些定义生成数据。</p>
<p>数据生成可以像横截面设计(cross-sectional
design)或前瞻性队列设计(prospective cohort
design)一样简单，也可以稍复杂一些。</p>
<p>模拟可以包括观察性或随机的治疗分配/暴露，生存数据，纵向/面板数据(longitudinal/panel
data)，多级/分层数据(multi-level/hierarchical
data)，基于特定协方差结构的相关变量的数据集，以及由任何类型的缺失模式导致的缺失数据的数据集。</p>
<blockquote>
<ul>
<li>Longitudinal
Data/纵向数据：对同一组受试个体在不同时间上的重复观测。<br></li>
<li>Panel
Data/面板数据(平行数据)：指在时间序列上取多个截面,在这些截面上同时选取样本观测值所构成的样本数据。</li>
</ul>
</blockquote>
<p>在<code>simstudy包</code>中模拟数据的关键是创建一系列数据定义表(data
definition table)，如下所示：</p>
<figure>
<img
src="http://qiniup.louyanspine.com/2018-07-22-data%20definition%20tables.png"
alt="data definition tables" />
<figcaption aria-hidden="true">data definition tables</figcaption>
</figure>
<p>用于生成上述定义的代码 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">library(simstudy)</span><br><span class="line">library(data.table)</span><br><span class="line"></span><br><span class="line">def &lt;- defData(varname = &quot;nr&quot;, dist = &quot;nonrandom&quot;, formula = 7, id = &quot;idnum&quot;)</span><br><span class="line">def &lt;- defData(def, varname = &quot;x1&quot;, dist = &quot;uniform&quot;, formula = &quot;10;20&quot;)</span><br><span class="line">def &lt;- defData(def, varname = &quot;y1&quot;, formula = &quot;nr + x1 * 2&quot;, variance = 8)</span><br><span class="line">def &lt;- defData(def, varname = &quot;y2&quot;, dist = &quot;poisson&quot;, formula = &quot;nr - 0.2 * x1&quot;, link = &quot;log&quot;)</span><br><span class="line">def &lt;- defData(def, varname = &quot;xCat&quot;, formula = &quot;0.3;0.2;0.5&quot;, dist = &quot;categorical&quot;)</span><br><span class="line">def &lt;- defData(def, varname = &quot;g1&quot;, dist = &quot;gamma&quot;, formula = &quot;5+xCat&quot;, variance = 1, link = &quot;log&quot;)</span><br><span class="line">def &lt;- defData(def, varname = &quot;a1&quot;, dist = &quot;binary&quot;, formula = &quot;-3 + xCat&quot;, link = &quot;logit&quot;)</span><br></pre></td></tr></table></figure>
要根据这些定义创建一个简单的数据集，所有人都需要执行一个<code>genData</code>命令。</p>
<p>在此示例中，我们生成500条记录，这些记录基于<code>def表</code>中的定义：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">dt &lt;- genData(500, def)</span><br><span class="line"></span><br><span class="line">    idnum nr       x1       y1  y2 xCat          g1 a1</span><br><span class="line">  1:     1  7 11.14037 34.04765 138    3   637.50317  1</span><br><span class="line">  2:     2  7 11.92208 30.44868 100    1    79.01242  0</span><br><span class="line">  3:     3  7 16.18471 39.71205  37    3    73.57740  0</span><br><span class="line">  4:     4  7 15.99059 38.68228  37    1   115.78951  0</span><br><span class="line">  5:     5  7 10.61884 30.63140 137    3 11407.90428  1</span><br><span class="line"> ---                                                   </span><br><span class="line">496:   496  7 16.95754 38.20793  38    3   954.34293  0</span><br><span class="line">497:   497  7 17.38688 46.24585  41    1    23.14826  0</span><br><span class="line">498:   498  7 13.10723 38.21072  69    3  3799.37787  0</span><br><span class="line">499:   499  7 13.40657 33.17099  78    1  1512.06894  0</span><br><span class="line">500:   500  7 11.72582 36.90359 106    3  3903.30936  1</span><br></pre></td></tr></table></figure>
<h2
id="用重复测量模拟一项前瞻性队列研究">用重复测量模拟一项前瞻性队列研究</h2>
<p>问题是，我们是否可以模拟一项双臂研究(对照组和治疗组)，在三个时间点上重复测量：基线，1个月后和2个月后？
答案当然是of course。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"></span><br><span class="line"># Define the outcome</span><br><span class="line"> </span><br><span class="line">ydef &lt;- defDataAdd(varname = &quot;Y&quot;, dist = &quot;normal&quot;, </span><br><span class="line">                   formula = &quot;5 + 2.5*period + 1.5*T + 3.5*period*T&quot;, </span><br><span class="line">                   variance = 3)</span><br><span class="line"> </span><br><span class="line"># Generate a &#x27;blank&#x27; data.table with 24 observations and assign them to groups</span><br><span class="line"> </span><br><span class="line">set.seed(1234)</span><br><span class="line"> </span><br><span class="line">indData &lt;- genData(24)</span><br><span class="line">indData &lt;- trtAssign(indData, nTrt = 2, balanced = TRUE, grpName = &quot;T&quot;)</span><br><span class="line"> </span><br><span class="line"># Create a longitudinal data set of 3 records for each id</span><br><span class="line"> </span><br><span class="line">longData &lt;- addPeriods(indData, nPeriods = 3, idvars = &quot;id&quot;)</span><br><span class="line">longData &lt;- addColumns(dtDefs = ydef, longData)</span><br><span class="line"> </span><br><span class="line">longData[, `:=`(T, factor(T, labels = c(&quot;No&quot;, &quot;Yes&quot;)))]</span><br><span class="line"> </span><br><span class="line"># Let&#x27;s look at the data</span><br><span class="line"> </span><br><span class="line">ggplot(data = longData, aes(x = factor(period), y = Y)) + geom_line(aes(color = T, </span><br><span class="line">    group = id)) + scale_color_manual(values = c(&quot;#e38e17&quot;, &quot;#8e17e3&quot;)) + xlab(&quot;Time&quot;)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/22/Essential-Concepts-in-Clinical-Research/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/22/Essential-Concepts-in-Clinical-Research/" class="post-title-link" itemprop="url">临床研究基本概念：概述</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-22 13:10:44" itemprop="dateCreated datePublished" datetime="2018-07-22T13:10:44+08:00">2018-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-02-28 00:58:51" itemprop="dateModified" datetime="2019-02-28T00:58:51+08:00">2019-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%B4%E5%BA%8A%E7%A0%94%E7%A9%B6/" itemprop="url" rel="index"><span itemprop="name">临床研究</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote>
<p>说明：<br> 1. 部分参考Elsevier/The Lancet出版的The Lancet Handbook of
Essential Concepts in Clinical Research<br></p>
</blockquote>
<h2 id="一摘要">一、摘要</h2>
<ol type="1">
<li>根据研究者是否分配暴露因素将临床研究分为两大类：实验性和观察性。</li>
<li>实验性研究也可再分为两类：随机和非随机研究。</li>
<li>观察性研究可以是分析性的，也可以是描述性的。</li>
<li>分析性研究的特点是有一个比较(对照）组，而描述性研究则没有</li>
<li>在分析性研究中，队列研究追踪人群的时间方向是从暴露到结局。病例-对照研究与之相反是从结局回溯到暴露。横断面研究像一次快照，同时检测暴露和结局。</li>
<li>描述性研究，如个案报告则没有对照组。在这类研究中，研究者不能检测两者的因果关系，这是一个常常被遗忘或忽略的事实。</li>
<li>对相关性(association)的测量，如相对危险度或比值比。是常用的表达二分类结局（如患病和健康）的方法。相对危险度或比值比的可信区间提示了结果的精确性。</li>
<li>相关性测量(相对危险度或比值比)的可信区间显示了作用的强度、方向和可能的范围以及机遇发生的概率。与此相反，P仅表示机遇的大小。武断地用0.05的P来检验无效假设(Testing
null hypotheses)是没有医学基础的，也不应该鼓励。</li>
</ol>
<h2 id="二临床研究的分类">二、临床研究的分类</h2>
<blockquote>
<p>Scientific illiteracy is a major failing of medical education.<br>
科学无知是医学教育的主要问题。</p>
</blockquote>
<h3 id="一临床研究的分类方法">（一）临床研究的分类方法</h3>
<p><img
src="http://qiniup.louyanspine.com/2018-07-22-%E4%B8%B4%E5%BA%8A%E7%A0%94%E7%A9%B6%E7%9A%84%E5%88%86%E7%B1%BB.jpg" /></p>
<ol type="1">
<li>没有对照组的研究称为描述性研究。
<ul>
<li>最下端是个案报告(case report)</li>
<li>当报告的患者超过一个时，就称为病例系列报告(a case-series
report)</li>
</ul></li>
</ol>
<h3
id="二临床证据的分级rating-clinical-evidenceassessment-system-of-the-us-preventive-services-task-force美国预防服务工作组评估系统">（二）临床证据的分级/Rating
clinical evidence：Assessment system of the US Preventive Services Task
Force美国预防服务工作组评估系统</h3>
<table>
<colgroup>
<col style="width: 51%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">证据质量/Quality of evidence</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">I</td>
<td style="text-align: left;">Evidence from at least one properly
designed randomised controlled
trial.来自至少一个设计良好的随机对照临床试验中获得的证据</td>
</tr>
<tr class="even">
<td style="text-align: center;">II-1</td>
<td style="text-align: left;">Evidence obtained from well-designed
controlled trials without
randomisation.来自设计良好的非随机对照试验中获得的证据</td>
</tr>
<tr class="odd">
<td style="text-align: center;">II-2</td>
<td style="text-align: left;">Evidence from well-designed cohort or
case-control studies, preferably from more than one centre or research
group.来自设计良好的队列研究或病例对照研究(最好是多中心研究)的证据</td>
</tr>
<tr class="even">
<td style="text-align: center;">II-3</td>
<td style="text-align: left;">Evidence from multiple time series with or
without the intervention. Important results in uncontrolled experiments
(such as the introduction of penicillin treatment in the 1940s) could
also be considered as this type of
evidence.来自多个时间序列的、带有或不带有干预的研究得出的证据。重要的非对照试验(例如19世纪40年代青霉素的引入)的结果有时也可作为这一等级的证据。</td>
</tr>
<tr class="odd">
<td style="text-align: center;">III</td>
<td style="text-align: left;">Opinions of respected authorities, based
on clinical experience, descriptive studies, or reports of expert
committees.来自临床经验、描述性研究或专家委员会报告的权威意见</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 51%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">推荐强度/Strength of
recommendations</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: left;">Good evidence to support the
intervention.良好的科学证据支持该干预行为</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: left;">Fair evidence to support the
intervention.尚可的证据支持该干预行为</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: left;">Insufficient evidence to recommend for or
against the intervention, but recommendation might be made on other
grounds.没有足够的依据推荐或反对该干预行为，但在其他情况下可能会推荐</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: left;">Fair evidence against the
intervention.尚可的科学证据反对该干预行为</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: left;">Good evidence against the
intervention.良好的证据反对该干预行为</td>
</tr>
</tbody>
</table>
<h2 id="三研究可以做什么无法做什么">三、研究可以做什么，无法做什么</h2>
<blockquote>
<p>研究设计与研究问题是否匹配/Is the study design appropriate for the
question?</p>
</blockquote>
<h3 id="一描述性研究descriptive-study">（一）描述性研究/descriptive
study</h3>
<ol type="1">
<li>描述性研究可以阐述发病率(frequency)、自然病程和可能的决定因素(possible
determinants of a
condition)。这些结果显示多少人在一定时间患该病或发生某种状态，描述疾病和患病者的特征，并产生关于疾病的假设。这些假设可以通过更严格的研究来评价，如分析性研究或随机对照试验。</li>
<li>描述性研究没有对照组，不能用来评估因果关系(associations)。只有对照研究(分析性研究和实验性研究)才能够评估可能的因果关系。</li>
</ol>
<h3
id="二横断面研究cross-sectional-study特定时间的快照">（二）横断面研究(cross-sectional
study):特定时间的快照</h3>
<ol type="1">
<li><p>别名：频率调查(frequency survey)/现况研究(prevalence
study)</p></li>
<li><p>横断面研究用来检测在特定时间点上，疾病和某个暴露因素，两者的存在与否。这样，焦点是患病，而不是发病。因为结局和暴露在同一时间被确定，这两个的时间关系可能不清楚。</p>
<blockquote>
<p>例如假设横断面研究发现有关节炎的女性比没有关节炎的女性肥胖更常见。是增加的体重负担导致关节炎还是有关节炎的女性不得不减少活动然后出现肥胖呢？这种问题在横断面研究中是无法回答的。</p>
</blockquote></li>
<li><p>典型案例：检测心肌梗死男性患者收治入院时的血清胆固醇和他们的隔壁邻居的血清胆固醇。这种类型的研究同时提供了人群的瞬时疾病和健康状况。</p></li>
</ol>
<h3 id="三队列研究cohort-study从暴露到结局">（三）队列研究(cohort
study)：从暴露到结局</h3>
<ol type="1">
<li>调查者确定一组暴露于感兴趣的因素的人群和一组或多组不暴露的人群，然后随访暴露组和非暴露组一段时间来观察结局。如果暴露人群比不暴露人群有较高的结局发生率，那么暴露因素与该结局的高危险性相关。</li>
<li>优点
<ul>
<li>暴露因素在一开始就确定，可以认为暴露因素比结局发生要早，就不必像在病例-对照研究中那样考虑回忆偏倚(recall
bias)。</li>
<li>队列研究可以计算真正的发病率(true incidence
rates)、相对危险度(relative risk)和归因危险度(attributable risks)。</li>
</ul></li>
<li>缺点：但对于罕见事件或需要很多年才发病的疾病，这种类型的研究需要很长时间才有结果，因此费用非常高。</li>
<li>典型案例：从一项暴露开始(如口服避孕药),然后随访女性数年来评价其结局(如卵巢癌)，那它肯定是队列研究。队列研究可以是同期的，也可以是非同期的(即前瞻性和回顾性队列研究)。</li>
</ol>
<h3
id="四病例-对照研究case-control-study从结局到暴露">（四）病例-对照研究(Case-control
study)：从结局到暴露</h3>
<ol type="1">
<li>研究者定义一组有一种结局（如卵巢癌）的人群和一组没有该结局的人群(对照)，然后通过调查表、面谈或者其他方式确定两组人群某一危险因素的暴露情况（如口服避孕药、促排卵药物）。如果暴露因素在病例中的发生高于对照组，暴露因素与该结局的高危险性有关。</li>
<li>优点：省钱、省时</li>
<li>缺点：
<ul>
<li>选择合适的对照组比较困难。除了研究的结局外，对照应该是在其他所有重要的方面都与病例类似。不合适的对照破坏了很多病例-对照研究，并产生错误的结果。</li>
<li>回忆偏倚(recall
bias)(病例组比对照组对暴露因素的回忆更好)始终是依靠记忆研究的难题。</li>
<li>因为病例-对照研究缺乏分母，调查者不能计算发病率(incidence
rate)、相对危险度（relative risk, RR)以及归因危险度。</li>
<li>但可以用比值比（odds ratio,
OR)评价其相关性。当结局是不常见的时候(如绝大多数癌症)，比值比可以很好地代表相对危险度。</li>
</ul></li>
<li>典型案例：食物造成的疾病暴发。在游船上，呕吐腹泻的患者和没有生病的人都会被问及食物因素。如果生病的人中吃某一种食物的比例高于
未生病的人，这种食物就可疑了。</li>
</ol>
<figure>
<img
src="http://qiniup.louyanspine.com/2018-07-22-%E4%B8%89%E7%A7%8D%E7%A0%94%E7%A9%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%97%B6%E9%97%B4%E6%96%B9%E5%90%91%E7%A4%BA%E6%84%8F%E5%9B%BE.jpg"
alt="三种研究设计的时间方向示意图" />
<figcaption aria-hidden="true">三种研究设计的时间方向示意图</figcaption>
</figure>
<h3
id="五非随机试验non-randomised-trial">（五）非随机试验(non-randomised
trial)</h3>
<ol type="1">
<li><p>有些实验性研究不是随机将参加者分到暴露组中的(如治疗或预防策略研究)。和真正的随机不同的是，研究者常常用不够标准的方法，如交替分配(alternate
assignment)。</p>
<blockquote>
<p>交替分配：在一项试验中采用月份交替的方法来分配产妇的电子胎儿监测情况(一个月自由检查，另一个月限制检查)</p>
</blockquote></li>
<li><p>美国预防服务工作组和加拿大定期体检工作组（Canadian Task Force on
the Periodic Health
Examination)指定这种研究设计为II-1类，认为这种设计虽然不如随机试验严谨，但比其他分析性研究好。</p></li>
<li><p>在研究者将参加者分配到各治疗组中后，非随机试验就像队列研究一样实施和分析。暴露和未暴露的人随访一段时间以确定结局发生的频率。</p></li>
<li><p>优点</p>
<ul>
<li>有对照组</li>
<li>对照组和治疗组，在确认结局上有统一的标准。</li>
</ul></li>
<li><p>缺点：可能存在选择偏倚</p></li>
</ol>
<h3
id="六随机对照试验randomised-controlled-trials金标准">（六）随机对照试验(randomised
controlled trials)：金标准</h3>
<ol type="1">
<li>是临床研究中避免选择偏倚和混杂偏倚(confoundiiig
biases)的唯一方法。</li>
<li>随机对照试验的标志是：参加者分配到暴露因素中纯粹是随机的。</li>
<li>随机对照试验降低了确定结局时偏倚的可能性。如果正确的设计和完成，随机对照试验有可能避免偏倚，这样，对检验轻微的和中等程度的作用特别有效。在观察性研究中，偏倚很容易产生小的和中等程度的差异。
<ul>
<li>只要正确完成，随机分配可以杜绝选择偏倚(selection bias)</li>
<li>随机对照试验对于结局有统一的诊断标准，而且常常对参与者使用盲法，这样，减少了信息偏倚(information
bias)</li>
<li>随机对照试验独一无二的优势是消除混杂偏倚(confounding
bias)，包括已知的和未知的。</li>
</ul></li>
<li>随机对照试验的缺点
<ul>
<li>外部真实性(external
validity)：表示结果是否可以推广到更大区域或范围的程度。如果正确的实施,随机对照试验有内部真实性(internal
validity)(它按计划进行了检测)，但可能没有外部真实性。与观察性研究不同的是，随机对照试验只纳人通过筛查程序的志愿者。志愿参加试验的人与其他人有差异，比如，他们的健康状况可能比较好。</li>
<li>随机对照试验中有些情况下是不适用的，因为故意暴露于危险状态(如毒素、细菌或其他有害因素)是不道德的。</li>
<li>随机对照试验费用相当高</li>
</ul></li>
</ol>
<h2 id="四结局的测量">四、结局的测量</h2>
<h3 id="一术语">（一）术语</h3>
<p><img
src="http://qiniup.louyanspine.com/2018-07-22-%E4%BB%A4%E4%BA%BA%E5%9B%B0%E6%83%91%E7%9A%84%E7%BB%93%E5%B1%80%E6%9C%AF%E8%AF%AD.jpg" /></p>
<h4 id="比值ratio">比值(ratio)</h4>
<ol type="1">
<li>是一个数目除以另一个数目得到的值。</li>
<li>这两个数目可以相关也可以不相关。</li>
<li>这一特点(分子和分母的相关性)将比分为两种：
<ul>
<li>分母包含分子</li>
<li>分母不包含分子
<ul>
<li>产妇死亡比：死于妊娠相关的病因的妇女为分子，活产的母亲(常常用100000)为分母。然而，不是所有的分子都包含在分母中（比如，死于异位妊娠的妇女不可能被包含在活产的母亲中)</li>
</ul></li>
</ul></li>
</ol>
<h4 id="率rate">率(rate)</h4>
<ol type="1">
<li>率(rate)考量的是人群中事件的频率</li>
<li>率的分子(发生结局的人数)必须包含在分母(有发生结局这一危险的人数)中</li>
<li>率包含时间成分。</li>
<li>发病率(incidence
rate)：表示在特定的时间段中处于危险的人群中新发病例的数目（比如11个结核病例/100000人/年)。</li>
</ol>
<h4 id="比例">比例</h4>
<ol type="1">
<li>比例(proportion)常用作率的同义词，但前者不含有时间成分。</li>
<li>比例和率一样必须分母含有分子。因为分子和分母的单位相同，他们相除后得到没有维度的数值，一个没有单位的数目。</li>
<li>例如患病比例(每100个处于危险的人中27个患枯草热)。这一数值表示处于危险的人群中有多少人在特定的时间中处于某种状态(这里是27%)。因为没有记录某段时间的新发病例，把患病率(prevalence
rate)看作比例(而不是率)更合适。</li>
</ol>
<h2 id="五相关性association的测量">五、相关性(association)的测量</h2>
<h3 id="一相对危险度relative-riskrr">（一）相对危险度(relative
risk,RR)</h3>
<ol type="1">
<li>定义：暴露组中发生结局的频率除以非暴露组中结局的频率。</li>
<li>解释
<ul>
<li>如果结局在两组中的频率是相同的，比值为1.0,表示暴露与结局没有关联</li>
<li>如果结局在暴露组中更频繁，比值就大于1.0,提示暴露与危险性增加相关</li>
<li>如果疾病频率在暴露组中低，相对危险度就会小于1.0，提示一种保护性作用</li>
</ul></li>
</ol>
<h3
id="二比值比odds-ratioor交叉乘积比cross-products-ratio相对比值relative-odds">（二）比值比(odds
ratio,OR)/交叉乘积比(cross-products ratio)/相对比值(relative odds)</h3>
<p>是病例-对照研究中常用的衡量相关性的方法</p>
<ol type="1">
<li>定义：在病例组中暴露的可能性除以对照组中暴露的可能性。</li>
<li>解释
<ul>
<li>如果病例组和对照组暴露的可能性相等，比值比为1.0，提示没有意义</li>
<li>如果病例组暴露的可能性高于对照组，比值就高于1.0，提示暴露与危险性增高有关</li>
<li>比值比低于1.0提示保护性作用</li>
</ul></li>
<li>横断面研究、队列研究和随机对照研究中也可以计算比值比。
<ul>
<li>疾病比值比是暴露组中发生疾病的可能性除以非暴露组中发生疾病的可能性</li>
<li>在这种情况下，如果在荟萃分析中汇集研究的时候，比值比就有一些吸引人的统计学特点</li>
<li>但当结局发生的比例大于5%〜10%的时候，比值比不能代表相对危险度(例如，发病率高的时候这一术语没有什么临床关联和意义）</li>
</ul></li>
</ol>
<h3 id="三可信区间confidence-intervals">（三）可信区间(confidence
intervals)</h3>
<ol type="1">
<li>可信区间反映了研究结果的精确性，提供了一个参数(如比例、相对危险度或者比值比）的数值范围，表示了含有来自于整个人群的研究样本的真实值的可能性。</li>
<li>尽管95%可信区间是最常用的，其他的，如90%可信区间也可以见到。</li>
<li>可信区间越大，结果的精确性越差，反之亦然。</li>
<li>对相对危险度和比值比来说，当95%可信区间不包括1.0时，在常用的0.05水平差别有显著性。但是，将可信区间的这一特性作为假设检验的内推方法是不合适的。</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/21/Markdownmath/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/21/Markdownmath/" class="post-title-link" itemprop="url">在Markdown中写数学公式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-21 23:54:36" itemprop="dateCreated datePublished" datetime="2018-07-21T23:54:36+08:00">2018-07-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-02-14 02:08:32" itemprop="dateModified" datetime="2022-02-14T02:08:32+08:00">2022-02-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">数学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="行内公式">行内公式</h2>
<p>语法是<code>$行内公式$</code>。可以让公式在文中与文字或其他东西混编，不独占一行。</p>
<ol type="1">
<li>示例
<ul>
<li><code>质能方程$E = mc^2$</code></li>
</ul></li>
<li>显示
<ul>
<li>质能方程<span class="math inline">\(E = mc^2\)</span></li>
</ul></li>
</ol>
<h2 id="独立公式">独立公式</h2>
<p>语法是<code>$$行内公式$$</code>。使公式单独占一行，不与文中其他文字等混编。</p>
<ol type="1">
<li>示例
<ul>
<li><code>质能方程$$E = mc^2$$</code></li>
</ul></li>
<li>显示
<ul>
<li>质能方程<span class="math display">\[E = mc^2\]</span></li>
</ul></li>
</ol>
<h2 id="普通公式">普通公式</h2>
<p>普通的加减乘除数学公式的输入方法与平常的书写一样。</p>
<ol type="1">
<li>示例
<ul>
<li><code>$$x = 100 * y + z - 10 / 33 + 10 % 3$$</code></li>
</ul></li>
<li>显示
<ul>
<li><span class="math display">\[x = 100 * y + z - 10 / 33 + 10 %
3\]</span></li>
</ul></li>
</ol>
<h2 id="上下标">上下标</h2>
<p>使用<code>^</code>来表示上标，<code>_</code>来表示下标，同时如果上下标的内容多于一个字符，可以使用<code>&#123;&#125;</code>来将这些内容括起来当做一个整体。</p>
<ol type="1">
<li>示例
<ul>
<li><code>$$x = a_&#123;1&#125;^n + a_&#123;2&#125;^n + a_&#123;3&#125;^n$$</code></li>
</ul></li>
<li>显示
<ul>
<li><span class="math display">\[x = a_{1}^n + a_{2}^n +
a_{3}^n\]</span></li>
</ul></li>
</ol>
<p>如果希望左右两边都能有上下标，可以使用<code>\sideset</code>语法</p>
<ol type="1">
<li>示例
<ul>
<li><code>$$\sideset&#123;^1_2&#125;&#123;^3_4&#125;A$$</code></li>
</ul></li>
<li>显示
<ul>
<li><span class="math display">\[\sideset{^1_2}{^3_4}A\]</span></li>
</ul></li>
</ol>
<h2 id="括号">括号</h2>
<p><code>()</code>，<code>[]</code>和<code>|</code>都表示它们自己，但是<code>&#123;&#125;</code>因为有特殊作用因此当需要显示大括号时一般使用<code>\lbrace \rbrace</code>来表示。</p>
<ol type="1">
<li>示例
<ul>
<li><code>$$f(x, y) = 100 * \lbrace[(x + y) * 3] - 5\rbrace$$</code></li>
</ul></li>
<li>显示
<ul>
<li><span class="math display">\[f(x, y) = 100 * \lbrace[(x + y) * 3] -
5\rbrace\]</span></li>
</ul></li>
</ol>
<h2 id="分数">分数</h2>
<p>分数使用<code>\frac&#123;分子&#125;&#123;分母&#125;</code>这样的语法，不过推荐使用<code>\cfrac</code>来代替<code>\frac</code>，显示公式不会太挤。</p>
<ol type="1">
<li>示例
<ul>
<li><code>$$\frac&#123;1&#125;&#123;3&#125; 与 \cfrac&#123;1&#125;&#123;3&#125;$$</code></li>
</ul></li>
<li>显示
<ul>
<li><span class="math display">\[\frac{1}{3} 与
\cfrac{1}{3}\]</span></li>
</ul></li>
</ol>
<h2 id="开方">开方</h2>
<p>开方使用<code>\sqrt[次数]&#123;被开方数&#125;</code>这样的语法</p>
<ol type="1">
<li>示例
<ul>
<li><code>$$\sqrt[3]&#123;X&#125;$$</code></li>
<li><code>$$\sqrt&#123;5 - x&#125;$$</code></li>
</ul></li>
<li>显示
<ul>
<li><span class="math display">\[\sqrt[3]{X}\]</span></li>
<li><span class="math display">\[\sqrt{5 - x}\]</span></li>
</ul></li>
</ol>
<h2 id="希腊字母">希腊字母</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">代码</th>
<th style="text-align: center;">大写</th>
<th style="text-align: center;">代码</th>
<th style="text-align: center;">小写</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>A</code></td>
<td style="text-align: center;"><span
class="math inline">\(A\)</span></td>
<td style="text-align: center;"><code>\alpha</code></td>
<td style="text-align: center;"><span
class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>B</code></td>
<td style="text-align: center;"><span
class="math inline">\(B\)</span></td>
<td style="text-align: center;"><code>\beta</code></td>
<td style="text-align: center;"><span
class="math inline">\(\beta\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\Gamma</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Gamma\)</span></td>
<td style="text-align: center;"><code>\gamma</code></td>
<td style="text-align: center;"><span
class="math inline">\(\gamma\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\Delta</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Delta\)</span></td>
<td style="text-align: center;"><code>\delta</code></td>
<td style="text-align: center;"><span
class="math inline">\(\delta\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>E</code></td>
<td style="text-align: center;"><span
class="math inline">\(E\)</span></td>
<td style="text-align: center;"><code>\epsilon</code></td>
<td style="text-align: center;"><span
class="math inline">\(\epsilon\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>Z</code></td>
<td style="text-align: center;"><span
class="math inline">\(Z\)</span></td>
<td style="text-align: center;"><code>\zeta</code></td>
<td style="text-align: center;"><span
class="math inline">\(\zeta\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>H</code></td>
<td style="text-align: center;"><span
class="math inline">\(H\)</span></td>
<td style="text-align: center;"><code>\eta</code></td>
<td style="text-align: center;"><span
class="math inline">\(\eta\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\Theta</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Theta\)</span></td>
<td style="text-align: center;"><code>\theta</code></td>
<td style="text-align: center;"><span
class="math inline">\(\theta\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>I</code></td>
<td style="text-align: center;"><span
class="math inline">\(I\)</span></td>
<td style="text-align: center;"><code>\iota</code></td>
<td style="text-align: center;"><span
class="math inline">\(\iota\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>K</code></td>
<td style="text-align: center;"><span
class="math inline">\(K\)</span></td>
<td style="text-align: center;"><code>\kappa</code></td>
<td style="text-align: center;"><span
class="math inline">\(\kappa\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\Lambda</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Lambda\)</span></td>
<td style="text-align: center;"><code>\lambda</code></td>
<td style="text-align: center;"><span
class="math inline">\(\lambda\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>M</code></td>
<td style="text-align: center;"><span
class="math inline">\(M\)</span></td>
<td style="text-align: center;"><code>\mu</code></td>
<td style="text-align: center;"><span
class="math inline">\(\mu\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>N</code></td>
<td style="text-align: center;"><span
class="math inline">\(N\)</span></td>
<td style="text-align: center;"><code>\nu</code></td>
<td style="text-align: center;"><span
class="math inline">\(\nu\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\Xi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Xi\)</span></td>
<td style="text-align: center;"><code>\xi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\xi\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>O</code></td>
<td style="text-align: center;"><span
class="math inline">\(O\)</span></td>
<td style="text-align: center;"><code>\omicron</code></td>
<td style="text-align: center;"><span
class="math inline">\(\omicron\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\Pi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Pi\)</span></td>
<td style="text-align: center;"><code>\pi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\pi\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>P</code></td>
<td style="text-align: center;"><span
class="math inline">\(P\)</span></td>
<td style="text-align: center;"><code>\rho</code></td>
<td style="text-align: center;"><span
class="math inline">\(\rho\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\Sigma</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Sigma\)</span></td>
<td style="text-align: center;"><code>\sigma</code></td>
<td style="text-align: center;"><span
class="math inline">\(\sigma\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>T</code></td>
<td style="text-align: center;"><span
class="math inline">\(T\)</span></td>
<td style="text-align: center;"><code>\tau</code></td>
<td style="text-align: center;"><span
class="math inline">\(\tau\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\Upsilon</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Upsilon\)</span></td>
<td style="text-align: center;"><code>\upsilon</code></td>
<td style="text-align: center;"><span
class="math inline">\(\upsilon\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\Phi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Phi\)</span></td>
<td style="text-align: center;"><code>\phi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\phi\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>X</code></td>
<td style="text-align: center;"><span
class="math inline">\(X\)</span></td>
<td style="text-align: center;"><code>\chi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\chi\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\Psi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Psi\)</span></td>
<td style="text-align: center;"><code>\psi</code></td>
<td style="text-align: center;"><span
class="math inline">\(\psi\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\Omega</code></td>
<td style="text-align: center;"><span
class="math inline">\(\Omega\)</span></td>
<td style="text-align: center;"><code>\omega</code></td>
<td style="text-align: center;"><span
class="math inline">\(\omega\)</span></td>
</tr>
</tbody>
</table>
<h2 id="关系运算符">关系运算符</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">代码</th>
<th style="text-align: center;">符号</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>\pm</code></td>
<td style="text-align: center;"><span
class="math inline">\(\pm\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\times</code></td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\div</code></td>
<td style="text-align: center;"><span
class="math inline">\(\div\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\mid</code></td>
<td style="text-align: center;"><span
class="math inline">\(\mid\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\nmid</code></td>
<td style="text-align: center;"><span
class="math inline">\(\nmid\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\cdot</code></td>
<td style="text-align: center;"><span
class="math inline">\(\cdot\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\circ</code></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\ast</code></td>
<td style="text-align: center;"><span
class="math inline">\(\ast\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\bigodot</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bigodot\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\bigotimes</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bigotimes\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\bigoplus</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bigoplus\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\leq</code></td>
<td style="text-align: center;"><span
class="math inline">\(\leq\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\geq</code></td>
<td style="text-align: center;"><span
class="math inline">\(\geq\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\neq</code></td>
<td style="text-align: center;"><span
class="math inline">\(\neq\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\approx</code></td>
<td style="text-align: center;"><span
class="math inline">\(\approx\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\equiv</code></td>
<td style="text-align: center;"><span
class="math inline">\(\equiv\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\sum</code></td>
<td style="text-align: center;"><span
class="math inline">\(\sum\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\prod</code></td>
<td style="text-align: center;"><span
class="math inline">\(\prod\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\coprod</code></td>
<td style="text-align: center;"><span
class="math inline">\(\coprod\)</span></td>
</tr>
</tbody>
</table>
<h2 id="集合运算符">集合运算符</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">代码</th>
<th style="text-align: center;">符号</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>\emptyset</code></td>
<td style="text-align: center;"><span
class="math inline">\(\emptyset\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\in</code></td>
<td style="text-align: center;"><span
class="math inline">\(\in\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\notin</code></td>
<td style="text-align: center;"><span
class="math inline">\(\notin\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\subset</code></td>
<td style="text-align: center;"><span
class="math inline">\(\subset\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\supset</code></td>
<td style="text-align: center;"><span
class="math inline">\(\supset\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\subseteq</code></td>
<td style="text-align: center;"><span
class="math inline">\(\subseteq\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\supseteq</code></td>
<td style="text-align: center;"><span
class="math inline">\(\supseteq\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\bigcap</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bigcap\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\bigcup</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bigcup\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\bigvee</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bigvee\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\bigwedge</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bigwedge\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\biguplus</code></td>
<td style="text-align: center;"><span
class="math inline">\(\biguplus\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\bigsqcup</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bigsqcup\)</span></td>
</tr>
</tbody>
</table>
<h2 id="对数运算符">对数运算符</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">代码</th>
<th style="text-align: center;">符号</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>\log</code></td>
<td style="text-align: center;"><span
class="math inline">\(\log\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\lg</code></td>
<td style="text-align: center;"><span
class="math inline">\(\lg\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\ln</code></td>
<td style="text-align: center;"><span
class="math inline">\(\ln\)</span></td>
</tr>
</tbody>
</table>
<h2 id="三角运算符">三角运算符</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">代码</th>
<th style="text-align: center;">符号</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>\bot</code></td>
<td style="text-align: center;"><span
class="math inline">\(\bot\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\angle</code></td>
<td style="text-align: center;"><span
class="math inline">\(\angle\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\sin</code></td>
<td style="text-align: center;"><span
class="math inline">\(\sin\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\cos</code></td>
<td style="text-align: center;"><span
class="math inline">\(\cos\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\tan</code></td>
<td style="text-align: center;"><span
class="math inline">\(\tan\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\cot</code></td>
<td style="text-align: center;"><span
class="math inline">\(\cot\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\sec</code></td>
<td style="text-align: center;"><span
class="math inline">\(\sec\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\csc</code></td>
<td style="text-align: center;"><span
class="math inline">\(\csc\)</span></td>
</tr>
</tbody>
</table>
<h2 id="微积分运算符">微积分运算符</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">代码</th>
<th style="text-align: center;">符号</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>\prime</code></td>
<td style="text-align: center;"><span
class="math inline">\(\prime\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\int</code></td>
<td style="text-align: center;"><span
class="math inline">\(\int\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\iint</code></td>
<td style="text-align: center;"><span
class="math inline">\(\iint\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\iiint</code></td>
<td style="text-align: center;"><span
class="math inline">\(\iiint\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\iiiint</code></td>
<td style="text-align: center;"><span
class="math inline">\(\iiiint\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\oint</code></td>
<td style="text-align: center;"><span
class="math inline">\(\oint\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\lim</code></td>
<td style="text-align: center;"><span
class="math inline">\(\lim\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\infty</code></td>
<td style="text-align: center;"><span
class="math inline">\(\infty\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>\nabla</code></td>
<td style="text-align: center;"><span
class="math inline">\(\nabla\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>\mathrm&#123;d&#125;</code></td>
<td style="text-align: center;"><span
class="math inline">\(\mathrm{d}\)</span></td>
</tr>
</tbody>
</table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/21/mathjax/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/21/mathjax/" class="post-title-link" itemprop="url">使用mathjax引擎在Markdown中插入数学公式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-21 08:02:28" itemprop="dateCreated datePublished" datetime="2018-07-21T08:02:28+08:00">2018-07-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-02-28 00:50:29" itemprop="dateModified" datetime="2019-02-28T00:50:29+08:00">2019-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">数学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote>
<p>说明<br> 1.
部分参考自博客[始终]上文章：<a target="_blank" rel="noopener" href="https://liam0205.me/2015/09/09/fix-conflict-between-mathjax-and-markdown/">解决MathJax与Markdown的冲突</a><br>
2.
部分参考自博客[天空的城]上的文章：<a target="_blank" rel="noopener" href="http://shomy.top/2016/10/22/hexo-markdown-mathjax/">Hexo下mathjax的转义问题</a></p>
</blockquote>
<p><img
src="http://qiniup.louyanspine.com/2018-07-22-Tutorial%20add%20MathJax%20with%20Blogger%20-1-.png" /></p>
<h2 id="启用mathjax插件">启用Mathjax插件</h2>
<ol type="1">
<li><p>安装：<code>cd</code>进入Hexo的根目录</p>
<p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-math --save</span><br></pre></td></tr></table></figure></p></li>
<li><p>配置</p>
<p>在站点配置文件<code>_config.yml</code>中加入下述代码：</p>
<p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">math:</span><br><span class="line">  engine: &#x27;mathjax&#x27; # or &#x27;katex&#x27;</span><br><span class="line">  mathjax:</span><br><span class="line">    src: custom_mathjax_source</span><br><span class="line">    config:</span><br><span class="line">      # MathJax config</span><br><span class="line">  katex:</span><br><span class="line">    css: custom_css_source</span><br><span class="line">    js: custom_js_source # not used</span><br><span class="line">    config:</span><br><span class="line">      # KaTeX config</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h2 id="next如何集成mathjax">NexT如何集成mathjax？</h2>
<p>可以在<code>next</code>文件中的主题配置文件<code>_config.xml</code>下做类似如下配置后便可用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># MathJax Support</span><br><span class="line">mathjax:</span><br><span class="line">  enable: true</span><br><span class="line">  per_page: false</span><br><span class="line">  cdn: //cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML</span><br></pre></td></tr></table></figure>
<h2
id="如果框架不提供配置怎么集成mathjax">如果框架不提供配置怎么集成mathjax?</h2>
<p>只要在需要集成的页面上加载一个script即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;</span><br><span class="line">   src=&quot;http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot;&gt;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="如何复制别人的mathjax代码">如何复制别人的mathjax代码？</h2>
<ol type="1">
<li><p>可以查看网页源码。</p></li>
<li><p>可以直接在公式上右键，按照如下图的操作后便可看到代码。</p>
<p><img
src="http://qiniup.louyanspine.com/2018-07-22-mathjax.jpg" /></p></li>
<li><p>在线识别手写数学公式并转换为的mathjax代码<a target="_blank" rel="noopener" href="https://webdemo.myscript.com/views/main/math.html">网站</a></p></li>
</ol>
<h2 id="mathjax与markdown的冲突">MathJax与Markdown的冲突</h2>
<p>MathJax是一个JavaScript引擎，能够将LaTeX语法书写的公式在网页上显示出来。Markdown是一种轻量级的标记语言。用Markdown书写的文章，可以用Markdown解释器处理成标准的HTML文档。因此Markdown很适合用来写博客。</p>
<p>在Markdown中，下划线<code>_</code>被保留，用作标记符号。比如<code>_Slant_</code>会生成倾斜的_Slant_。在LaTeX中，下划线<code>_</code>被用作下标记号。比如<code>x_i</code>会生成<span
class="math inline">\(x_i\)</span>。</p>
<p>由于 Markdown 在 MathJax 之前起作用，有时下标记号会被 Markdown
吃掉，变成 HTML 标记<code>&lt;i&gt;</code>而失去 LaTeX
的下标效果，造成数学公式显示不正常。</p>
<p>比如<code>This is an example: $f_i = f_&#123;i + 1&#125;$</code>里的两个下划线会被Markdown理解成倾斜的标记，显示成这样：</p>
<p><img
src="http://qiniup.louyanspine.com/2018-07-22-%E9%94%99%E8%AF%AF%E6%98%BE%E7%A4%BA.png" /></p>
<h3 id="解决方案">解决方案</h3>
<ol type="1">
<li><p>更换Hexo的markdown引擎</p>
<p>把Hexo默认的渲染markdown的引擎替换成插件pandoc<a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-renderer-pandoc">(hexo-renderer-pandoc)</a>进行渲染。但pandoc的语法与markdown有些微的差异，需要注意。</p>
<ul>
<li><p>安装<a target="_blank" rel="noopener" href="https://pandoc.org/installing.html">pandoc</a></p></li>
<li><p><code>cd</code>进入Hexo的根目录，卸载Hexo默认的markd，再安装pandoc</p>
<p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-pandoc --save</span><br></pre></td></tr></table></figure></p></li>
</ul></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/18/confounding-biases-estimatess/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/18/confounding-biases-estimatess/" class="post-title-link" itemprop="url">Visualizing how confounding biases estimates of population-wide (or marginal) average causal effects？？？(未完)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-18 21:46:11" itemprop="dateCreated datePublished" datetime="2018-07-18T21:46:11+08:00">2018-07-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-02-28 01:02:11" itemprop="dateModified" datetime="2019-02-28T01:02:11+08:00">2019-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">统计学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote>
<p>说明<br> 1. 译自Keith Goldfeld的文章Visualizing how confounding
biases estimates of population-wide (or marginal) average causal
effects</p>
</blockquote>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>
<p>当我们试图评估暴露或干预对结果的影响时，混淆因素(confounding)对我们得出正确结论的能力始终存在威胁。我的目标是考虑一下如何描述混淆的方式，使得有可能从表面上看出为什么不正确地估计干预效应(intervention
effects)可能会导致偏倚。</p>
<h3 id="混淆潜在的结果和因果效应">混淆、潜在的结果和因果效应</h3>
<p>通常，我们认为混淆因素会影响暴露和结果。如果，我们在评价暴露效果的时候，忽略混杂因素，我们可能轻易地高估或低估由于暴露所造成的效果大小。</p>
<p>如果病情较重的患者比健康的患者更有可能服用某种特定的药物，那么服用该药的患者，其相对较差的预后，可能是由于最初的健康状况而不是药物造成的。</p>
<p>一个稍微不同的混淆因素的观点与潜在结果的概念性框架相关联。如果一个个体受到特定的暴露，我们可能会观察到一个潜在的结果。我们可能会或可能不会观察到潜在的结果：这取决于实际的暴露程度。（为了简化，假定我们只对两种不同的暴露感兴趣。）</p>
<p><span class="math inline">\(Y_0\)</span>代表患者未受到暴露，<span
class="math inline">\(Y_1\)</span>代表患者受到暴露。暴露因素对个人i的因果影响(causal
effect)可以被定义为<span
class="math inline">\(Y_{1i}-Y_{0i}\)</span>。</p>
<p>如果我们有足够长的时间来观察两种状态（有或没有暴露）下，每一个研究对象的结局<span
class="math inline">\(Y\)</span>，并测量两种潜在的结局以及因果效应。对样本中所有个体进行平均，可以估计人口平均因果效应。(Think
of a crossover or N-of-1 study.)</p>
<p>不幸的是，在现实世界中，将个体暴露于多种条件下几乎是不可行的。只能设置对照组和暴露组，进行比较（除了暴露因素以外，两组其他情况都相同）。</p>
<p>我们的目标是比较对照组与暴露组的结果分布。我们经常通过查看每个分布的均值来简化这种比较。</p>
<p>平均因果效应（所有个体）可以写成<span
class="math inline">\(E(Y_{1i}-Y_{0i})\)</span>。<span
class="math inline">\(E()\)</span>是期望值或平均值。实际上，我们无法直接衡量这一点，因为每个人只能观察到一个潜在的结果。</p>
<p>我们可以使用观察到的测量值来估计无法观察的平均因果效应。 <img
src="http://qiniup.louyanspine.com/2018-07-20-%E6%B7%B7%E6%B7%86%E5%9B%A0%E7%B4%A0-%E6%9C%9F%E6%9C%9B.jpg"
alt="混淆因素-期望" /></p>
<ol type="1">
<li>因为期望是线性的。故此：E(Y<sub>1</sub>-Y<sub>0</sub>)=E(Y<sub>1</sub>)-E(Y<sub>0</sub>)</li>
<li>可以说<span class="math display">\[A_1 = 5 \]</span></li>
</ol>
<p><span class="math display">\[\frac{a}{b}\]</span></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/18/IPTW/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/18/IPTW/" class="post-title-link" itemprop="url">逆概率加权处理（未完）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-18 21:39:21" itemprop="dateCreated datePublished" datetime="2018-07-18T21:39:21+08:00">2018-07-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2018-10-29 14:47:00" itemprop="dateModified" datetime="2018-10-29T14:47:00+08:00">2018-10-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">统计学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote>
<p>说明<br> 1. 部分参考O'Reilly Media出版的HTML and CSS和HTML with CSS
&amp; XHTML<br> 2.
部分参考作者兼续在简书上的笔记https://www.jianshu.com/p/727dbfcef685</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/18/Rtableone/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/18/Rtableone/" class="post-title-link" itemprop="url">利用tableone包绘制研究人群基线特征表</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-18 14:28:41" itemprop="dateCreated datePublished" datetime="2018-07-18T14:28:41+08:00">2018-07-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2018-10-29 14:47:00" itemprop="dateModified" datetime="2018-10-29T14:47:00+08:00">2018-10-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>在医学研究领域，通常用Table 1来描述所研究人群的特征情况。Table
1包含连续性变量的均值、分类变量所占百分比以及p值等信息。为了创建Table
1有时可能会非常耗时。想象一下：我们有3组数据，每组数据10个变量（如年龄，性别等），需对变量计算均值（标准差）、参与人数（百分比）。这样的话我们需要在表中填充60个数据。</p>
<p><code>tableone</code>包的作者是Kazuki Yoshida和Justin
Bohn，利用这个包可以很方便的在R中创建表格。</p>
<h2 id="一创建table-1">一、创建Table 1</h2>
<h3 id="一创建并导入数据">（一）创建并导入数据</h3>
<p>本文数据是由<code>rnorm()</code>和<code>sample()</code>函数模拟产生的，从<a target="_blank" rel="noopener" href="https://datascienceplus.com/wp-content/uploads/2016/02/dt_simulated.csv">这里</a>下载。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dt <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span>file.choose<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> header<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> sep<span class="operator">=</span><span class="string">&quot;,&quot;</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>dt<span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line">   Age Gender Cholesterol SystolicBP  BMI Smoking Education</span><br><span class="line"><span class="number">1</span> <span class="number">67.9</span> Female       <span class="number">236.4</span>      <span class="number">129.8</span> <span class="number">26.4</span>     Yes      High</span><br><span class="line"><span class="number">2</span> <span class="number">54.8</span> Female       <span class="number">256.3</span>      <span class="number">133.4</span> <span class="number">28.4</span>      No    Medium</span><br><span class="line"><span class="number">3</span> <span class="number">68.4</span>   Male       <span class="number">198.7</span>      <span class="number">158.5</span> <span class="number">24.1</span>     Yes      High</span><br><span class="line"><span class="number">4</span> <span class="number">67.9</span>   Male       <span class="number">205.0</span>      <span class="number">136.0</span> <span class="number">19.9</span>      No       Low</span><br><span class="line"><span class="number">5</span> <span class="number">60.9</span>   Male       <span class="number">207.7</span>      <span class="number">145.4</span> <span class="number">26.7</span>      No    Medium</span><br><span class="line"><span class="number">6</span> <span class="number">44.9</span> Female       <span class="number">222.5</span>      <span class="number">130.6</span> <span class="number">30.6</span>      No       Low</span><br></pre></td></tr></table></figure>
<h3 id="二设定变量并定义分类变量">（二）设定变量并定义分类变量</h3>
<p>现在，我们使用<code>tableone包</code>来创建Table 1。</p>
<ol type="1">
<li>首先加载<code>tableone包</code>，并创建我们想要放到Table
1中的变量列表。</li>
<li>定义分类变量。</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#加载tableone包</span></span><br><span class="line">library<span class="punctuation">(</span>tableone<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#创建变量列表</span></span><br><span class="line">listVars <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Age&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Gender&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Cholesterol&quot;</span><span class="punctuation">,</span> <span class="string">&quot;SystolicBP&quot;</span><span class="punctuation">,</span> <span class="string">&quot;BMI&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Smoking&quot;</span><span class="punctuation">,</span> </span><br><span class="line"><span class="string">&quot;Education&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义分类变量</span></span><br><span class="line">catVars <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Gender&quot;</span><span class="punctuation">,</span><span class="string">&quot;Smoking&quot;</span><span class="punctuation">,</span><span class="string">&quot;Education&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="三总体人群表格">（三）总体人群表格</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">table1 <span class="operator">&lt;-</span> CreateTableOne<span class="punctuation">(</span>vars <span class="operator">=</span> listVars<span class="punctuation">,</span> data <span class="operator">=</span> dt<span class="punctuation">,</span> factorVars <span class="operator">=</span> catVars<span class="punctuation">)</span></span><br><span class="line">  </span><br><span class="line">                              Overall       </span><br><span class="line">     n                          <span class="number">250</span>        </span><br><span class="line">  Age <span class="punctuation">(</span>mean <span class="punctuation">(</span>sd<span class="punctuation">)</span><span class="punctuation">)</span>          <span class="number">57.50</span> <span class="punctuation">(</span><span class="number">7.85</span><span class="punctuation">)</span> </span><br><span class="line">  Gender <span class="operator">=</span> Male <span class="punctuation">(</span><span class="operator">%)          107 (42.8) </span></span><br><span class="line"><span class="operator">  Cholesterol (mean (sd)) 224.12 (24.90)</span></span><br><span class="line"><span class="operator">  SystolicBP (mean (sd))  145.51 (10.08)</span></span><br><span class="line"><span class="operator">  BMI (mean (sd))          26.79 (4.37) </span></span><br><span class="line"><span class="operator">  Smoking = Yes (%</span><span class="punctuation">)</span>           <span class="number">72</span> <span class="punctuation">(</span><span class="number">28.8</span><span class="punctuation">)</span> </span><br><span class="line">  Education <span class="punctuation">(</span>%<span class="punctuation">)</span>                         </span><br><span class="line">     High                    <span class="number">108</span> <span class="punctuation">(</span><span class="number">43.2</span><span class="punctuation">)</span> </span><br><span class="line">     Low                      <span class="number">71</span> <span class="punctuation">(</span><span class="number">28.4</span><span class="punctuation">)</span> </span><br><span class="line">     Medium                   <span class="number">71</span> <span class="punctuation">(</span><span class="number">28.4</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="四特定人群分类表格">（四）特定人群（分类）表格</h3>
<p>我们更感兴趣的是分别为男性和女性创建Table
1，并比较他们的均值和百分比。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从变量列表中移除Gender</span></span><br><span class="line">listVar <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Age&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Cholesterol&quot;</span><span class="punctuation">,</span> <span class="string">&quot;SystolicBP&quot;</span><span class="punctuation">,</span> <span class="string">&quot;BMI&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Smoking&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Education&quot;</span><span class="punctuation">)</span></span><br><span class="line">table1 <span class="operator">&lt;-</span> CreateTableOne<span class="punctuation">(</span>listVars<span class="punctuation">,</span> dt<span class="punctuation">,</span> catVars<span class="punctuation">,</span> strata <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Gender&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">                         Stratified by Gender</span><br><span class="line">                            Female         Male           p test</span><br><span class="line">  n                          <span class="number">143</span>            <span class="number">107</span>                    </span><br><span class="line">  Age <span class="punctuation">(</span>mean <span class="punctuation">(</span>sd<span class="punctuation">)</span><span class="punctuation">)</span>          <span class="number">56.94</span> <span class="punctuation">(</span><span class="number">8.05</span><span class="punctuation">)</span>   <span class="number">58.25</span> <span class="punctuation">(</span><span class="number">7.55</span><span class="punctuation">)</span>   <span class="number">0.191</span>     </span><br><span class="line">  Cholesterol <span class="punctuation">(</span>mean <span class="punctuation">(</span>sd<span class="punctuation">)</span><span class="punctuation">)</span> <span class="number">224.80</span> <span class="punctuation">(</span><span class="number">25.06</span><span class="punctuation">)</span> <span class="number">223.21</span> <span class="punctuation">(</span><span class="number">24.78</span><span class="punctuation">)</span>  <span class="number">0.620</span>     </span><br><span class="line">  SystolicBP <span class="punctuation">(</span>mean <span class="punctuation">(</span>sd<span class="punctuation">)</span><span class="punctuation">)</span>  <span class="number">144.95</span> <span class="punctuation">(</span><span class="number">10.99</span><span class="punctuation">)</span> <span class="number">146.27</span> <span class="punctuation">(</span><span class="number">8.71</span><span class="punctuation">)</span>   <span class="number">0.305</span>     </span><br><span class="line">  BMI <span class="punctuation">(</span>mean <span class="punctuation">(</span>sd<span class="punctuation">)</span><span class="punctuation">)</span>          <span class="number">26.74</span> <span class="punctuation">(</span><span class="number">4.58</span><span class="punctuation">)</span>   <span class="number">26.84</span> <span class="punctuation">(</span><span class="number">4.09</span><span class="punctuation">)</span>   <span class="number">0.859</span>     </span><br><span class="line">  Smoking <span class="operator">=</span> Yes <span class="punctuation">(</span><span class="operator">%)           37 (25.9)      35 (32.7)   0.298     </span></span><br><span class="line"><span class="operator">  Education (%</span><span class="punctuation">)</span>                                          <span class="number">0.289</span>     </span><br><span class="line">     High                     <span class="number">56</span> <span class="punctuation">(</span><span class="number">39.2</span><span class="punctuation">)</span>      <span class="number">52</span> <span class="punctuation">(</span><span class="number">48.6</span><span class="punctuation">)</span>             </span><br><span class="line">     Low                      <span class="number">45</span> <span class="punctuation">(</span><span class="number">31.5</span><span class="punctuation">)</span>      <span class="number">26</span> <span class="punctuation">(</span><span class="number">24.3</span><span class="punctuation">)</span>             </span><br><span class="line">     Medium                   <span class="number">42</span> <span class="punctuation">(</span><span class="number">29.4</span><span class="punctuation">)</span>      <span class="number">29</span> <span class="punctuation">(</span><span class="number">27.1</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><code>tableone包</code>还可以做更多事情。例如：计算非正态分布变量的中位数和四分位数，对不同组之间作各种假设检验的对比。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lysp2017.github.io/2018/07/17/propensityscoreR-JCO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Louyan">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="高山流水">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/17/propensityscoreR-JCO/" class="post-title-link" itemprop="url">倾向性评分在临床研究中的应用（未完）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-17 20:47:28" itemprop="dateCreated datePublished" datetime="2018-07-17T20:47:28+08:00">2018-07-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-02-28 00:44:21" itemprop="dateModified" datetime="2019-02-28T00:44:21+08:00">2019-02-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">统计学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote>
<p>说明<br> 1. 译自Rajyaguru DJ于2018年发表在JCO上的文章：Radiofrequency
Ablation Versus Stereotactic BodyRadiotherapy for Localized
Hepatocellular Carcinoma inNonsurgically Managed Patients: Analysis of
the National Cancer Database.</p>
</blockquote>
<h2
id="射频消融与立体定向放疗对非手术治疗的局限性肝癌患者的影响国家癌症数据库分析">射频消融与立体定向放疗对非手术治疗的局限性肝癌患者的影响：国家癌症数据库分析</h2>
<h3 id="摘要">摘要</h3>
<h4 id="研究目的">研究目的</h4>
<p>对于局部肝细胞癌（HCC）的管理，目前尚缺乏指导（医生）如何选择最佳局部消融治疗的数据。由于这些治疗方式的前瞻性、可比较数据有限，因此我们的目的是通过使用国家癌症数据库比较射频消融（radiofrequency
ablation,RFA）与立体定向放射治疗（stereotactic body
radiotherapy,SBRT）的有效性(effectiveness)。</p>
<h4 id="方法">方法</h4>
<ol type="1">
<li>我们进行了一项观察性研究，以比较RFA与SBRT在非手术治疗肝癌患者(stage
I or II)中的有效性。</li>
<li>通过使用基于患者(patient-)，医疗设施(facility-)和肿瘤水平(tumor-level)特征的倾向性评分加权和倾向性评分匹配分析来比较总体生存率。</li>
<li>进行敏感性分析(A sensitivity
analysis)以评估严重的肝纤维化/肝硬化程度。</li>
<li>此外，我们进行了探索性分析(exploratory
analyses)，以确定RFA和SBRT在临床相关患者子集中的有效性。</li>
</ol>
<h4 id="结果">结果</h4>
<ol type="1">
<li>3,684例（92.6％）和296例（7.4％）非手术治疗的I期或II期HCC患者分别接受RFA或SBRT治疗。</li>
<li>在倾向性评分匹配后，RFA组的5年总体生存率为29.8％（95％CI，24.5％-35.3％），而SBRT组则为19.3％（95％CI，13.5％-25.9％），两者差异显著(P=0.001)。</li>
<li>逆概率加权分析(Inverse probability–weighted
analysis)也获得类似的结果。</li>
<li>RFA的获益在所有亚组中都是一致的，并且对严重肝纤维化/肝硬化的效果是稳健的。</li>
</ol>
<h4 id="结论">结论</h4>
<ol type="1">
<li>我们的研究表明，对于I或II期HCC的非手术治疗患者，与SBRT相比，RFA治疗可获得更高的存活率。</li>
<li>尽管我们的结果受限于回顾性研究设计相关的偏倚。但我们认为，在没有随机临床试验的情况下，在推荐局部无法切除的HCC患者进行局部消融治疗时应考虑我们的研究结果。</li>
</ol>
<h3 id="前言">前言</h3>
<ol type="1">
<li>对于局限性肝细胞癌，可以通过手术切除或肝移植实现治愈。然而，大多数患者不适合手术，而是采用局部消融治疗(local
ablative therapies)，包括射频消融（radiofrequency
ablation,RFA），微波消融(microwave
ablation)，冷冻消融(cryoablation)和立体定向放射治疗（stereotactic body
radiation therapy,SBRT）。</li>
<li>RFA广泛应用于体积较小（&lt;
3cm）的不可切除肝癌，可实现70％到90％的优良局部控制率，并且在某些情况下被认为是治愈性治疗。</li>
<li>其他介入技术，例如微波消融或联合热-经动脉化学栓塞已被用于改善局部控制率，特别是对于在3cm和5cm之间的HCC肿瘤。</li>
<li>SBRT是RFA的新兴替代方法，似乎为较小的HCC提供了类似的局部控制率。</li>
<li>尽管对SBRT的研究正在逐渐增加，但大多数SBRT的数据来自单中心，易于受到选择偏倚的影响。
此外，许多单中心的样本量相对较少，缺乏长期生存数据。</li>
<li>前瞻性随机试验对于比较RFA与SBRT治疗局部不可切除HCC的有效性是必要的。然而，目前尚无前瞻性随机试验，且进行此类试验面临许多挑战，耗时且花费较高。</li>
</ol>
<h3 id="研究方法">研究方法</h3>
<h4 id="数据来源">数据来源</h4>
<ol type="1">
<li>我们使用NCDB进行了回顾性分析，属于不受机构审查委员会监督的去标志数据(de-identified
data)。</li>
<li>NCDB是美国外科医师学会(American College of
Surgeons)癌症委员会（Commission on Cancer,CoC）和美国癌症协会(the
American Cancer Society)的联合项目。</li>
<li>NCDB包含来自美国1500多家拥有CoC认证项目的医院的数据，其中包括约70％全美所有新诊断的癌症病例，即超过2900万个独特的癌症病例。</li>
<li>根据与每个认证机构签订的协议，删除来自美国退伍军人事务部、国防部，波多黎各的设施和其他某些计划的数据。</li>
<li>我们从NCDB参与者用户文件（Participant User Files,PUF）获得数据。The
data elements are collected prospectively from cancer registries of
CoC-accredited programs by using nationally standardized data item and
coding definitions as specified in the CoC’s facility oncology registry
data standards and nationally standardized data transmission format
specifications coordinated by the North American Association of Central
Cancer Registries.</li>
<li>数据元素包括患者特征、癌症分期、肿瘤的组织学特征、首次治疗的类型和时间以及结果。</li>
<li>对于所有在5年内诊断出的符合条件的患者，合格评定(accreditation)要求每年有90％的随访率。</li>
</ol>
<h4 id="研究人群">研究人群</h4>
<ol type="1">
<li><p>从2004年至2013年间诊断为原发性HCC的119,933名男性和女性人群中共识别了47,634例临床I期（T1N0M0）或II期（T2N0M0）患者</p>
<blockquote>
<p>International Classification of Disease-Oncology-3rd Edition code
C22.0, histology codes 8170-8175</p>
</blockquote></li>
<li><p>排除接受过肺叶切除术，扩大肺叶切除术，肝切除术或肝移植的患者。</p></li>
<li><p>以RFA或SBRT作为主要治疗方式，排除接受其他形式的局部消融治疗的患者。</p></li>
<li><p>排除接受任何形式的化疗（辅助或新辅助）或化疗信息未知的患者。</p></li>
<li><p>本研究最终纳入3,980名患者。</p>
<figure>
<img
src="http://qiniup.louyanspine.com/2018-07-17-CONSORT%20diagram.jpg"
alt="CONSORT diagram" />
<figcaption aria-hidden="true">CONSORT diagram</figcaption>
</figure></li>
</ol>
<h4 id="covariates协变量">Covariates/协变量</h4>
<blockquote>
<p>可以在NCDB PUF数据dictionary中找到所有变量的完整详细描述。</p>
</blockquote>
<ol type="1">
<li>Patient-level variables
<ul>
<li>诊断时的年龄</li>
<li>性别</li>
<li>种族</li>
<li>保险状况</li>
<li>根据患者邮政编码的家庭收入中位数</li>
<li>患者人口普查区内低于高中教育的人口百分比</li>
<li>Charlson-Deyo合并症评分(被NCDB分为0,1,≥2的得分类别)</li>
</ul></li>
<li>Facility-level variables
<ul>
<li>从患者居住区到治疗设施的距离</li>
<li>case volume in quartiles</li>
<li>地理区域</li>
<li>type of treatment facilities(由CoC accreditation
category指定，基于case volume和available services)
<ul>
<li>社区</li>
<li>综合性社区</li>
<li>学术</li>
<li>integrated network cancer program</li>
</ul></li>
</ul></li>
<li>Tumor-level variables
<ul>
<li>TNM分期</li>
<li>肿瘤大小</li>
<li>诊断年份（2004-2008 v 2009-2013）</li>
<li>甲胎蛋白</li>
<li>肿瘤分级和Ishak纤维化评分可用于接受活检以评估肿瘤的患者</li>
</ul></li>
</ol>
<h4 id="目标">目标</h4>
<ol type="1">
<li><p>本研究的主要目的是比较非手术治疗的I期或II期HCC患者的总体生存期（overall
survival,OS），同时比较接受RFA治疗的患者与接受SBRT治疗的患者的OS。 &gt;
OS的定义：从诊断日期到死亡(任何原因所导致)日期。</p></li>
<li><p>次要目标是确定RFA和SBRT在临床相关患者子集中的有效性。</p></li>
</ol>
<h4 id="统计分析">统计分析</h4>
<ol type="1">
<li>评估治疗方式与患者的特点，临床特点及和医疗设施特征之间的相关性
<ul>
<li>分类数据：Pearson卡方,Fisher’s exact test</li>
<li>计量数据：Wilcoxon rank sum test</li>
</ul></li>
<li>对于主要结果，构建了两种OS与治疗方式之间相关性的模型
<ul>
<li>a propensity score-and time-to-treatment-matched univariable Cox
proportional hazards model
/倾向性评分和治疗时间匹配的单因素Cox比例风险模型</li>
<li>an unmatched univariable analysis based on the Kaplan-Meier
estimator of inverse probability of treatment weight
(IPTW)/基于IPTW的Kaplan-Meier估计量的未匹配的单因素分析</li>
</ul></li>
<li>构建以接受SBRT为目标事件构建模型的倾向性评分模型。
<ul>
<li>通过逐步多因素logistic回归模型。</li>
<li>变量选择：先进行单因素分析，纳入所有与治疗方法显著相关的变量(a
threshold of P &lt;0.20 required for initial inclusion and P &lt;0.10
required to remain in the model)。</li>
</ul></li>
<li>在倾向性评分的基础上，计算稳定的IPTW。IPTWs were truncated at
第5和第95百分位</li>
<li>构建倾向性评分和治疗时间匹配的OS模型
<ul>
<li>通过使用a greedy, nearest neighbor matching
algorithm，接受SBRT治疗的患者与接受RFA治疗的患者，在倾向性评分和诊断到治疗的时间上，匹配为1：2。倾向性评分的最大允许差异为±2％，诊断到治疗的时间的最大允许差异为±14天。</li>
<li>计算每组的Kaplan-Meier估计量，并使用对数秩检验(log-rank
test)进行比较。</li>
</ul></li>
<li>对于OS的最终模型，计算所有患者的IPTW
Kaplan-Meier估计量，并通过对数秩检验在各组之间进行比较。</li>
<li>所有计算均使用SAS软件9.4版进行。</li>
<li>在匹配的患者组中，我们通过交互作用(interaction)和亚组分析(subgroup
analyses)评估了治疗效果的异质性(heterogeneity of treatment
effects)，探讨了年龄，性别，临床T分期，肿瘤大小，肿瘤分级，Charlson-Deyo合并症评分和设施类型的影响。</li>
<li>由于在NCDB中纤维化/肝硬化例数较少，以及纤维化/肝硬化与OS减少之间的已知关联。我们在匹配的患者组中进行了敏感性分析，以研究这种未测量的混杂因素对我们的结果的潜在影响。</li>
<li>敏感性分析的目标是探索假设的结果情景，并在其中调整观察到的治疗效果以解释潜在的未测量的混杂因素。</li>
<li>除了观察到的治疗效果外，敏感性分析还纳入了关于生存效应和未测量混杂因子的不同暴露的假设信息，以计算如果去除未测量的混杂因素将会观察到的真实治疗效果。</li>
</ol>
<h3 id="结果-1">结果</h3>
<h4 id="factors-associated-with-use-of-sbrt">Factors Associated With Use
of SBRT</h4>
<ol type="1">
<li>开始SBRT和RFA治疗的中位时间分别为72天和48天。</li>
<li>患者基线特征列于表1中。 <img
src="http://qiniup.louyanspine.com/2018-07-17-Table%201.jpg"
alt="Table 1" /> <img
src="http://qiniup.louyanspine.com/2018-07-17-Table%201c.jpg"
alt="Table 1_c" /></li>
<li>通过倾向性评分和time to
treatment进行匹配，两组患者所有的协变量均取得了足够的组间平衡（见表A1）。
<img src="http://qiniup.louyanspine.com/2018-07-17-Table%20A1.jpg"
alt="表A1" /> <img
src="http://qiniup.louyanspine.com/2018-07-17-Table%20A1c.jpg"
alt="表A1_c" /></li>
<li>接受SBRT的患者比例随时间逐渐增加，年增长率为12％（P&lt;0.001;图2），大多数患者（79.7％）接受三至五次治疗。</li>
</ol>
<h4 id="生存分析">生存分析</h4>
<h4 id="严重纤维化肝硬化的影响">严重纤维化/肝硬化的影响</h4>
<h3 id="讨论">讨论</h3>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/54/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/54/">54</a><span class="page-number current">55</span><a class="page-number" href="/page/56/">56</a><span class="space">&hellip;</span><a class="page-number" href="/page/59/">59</a><a class="extend next" rel="next" href="/page/56/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Louyan</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">582</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2372</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Louyan</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
